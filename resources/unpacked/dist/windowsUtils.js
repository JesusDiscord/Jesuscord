"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.hasOwnProperty.call(e,r)&&__createBinding(t,e,r);return __setModuleDefault(t,e),t};Object.defineProperty(exports,"__esModule",{value:!0}),exports.addToRegistry=exports.spawnReg=exports.spawn=void 0;const child_process=__importStar(require("child_process")),path=__importStar(require("path")),regExe=process.env.SystemRoot?path.join(process.env.SystemRoot,"System32","reg.exe"):"reg.exe";function spawn(e,t,r){let n,o="";console.log(`[[33mDEBUG[0m] Spawning "${e} with args`,t);try{n=child_process.spawn(e,t)}catch(s){return void process.nextTick(()=>{null!=r&&r(s,o)})}n.stdout.on("data",e=>{o+=e});let s=null;n.on("error",e=>{null!=e&&(e=e)}),n.on("close",(e,t)=>{null===s&&0!==e&&(s=new Error("Command failed: "+(t||e))),null!=s&&(s.code=s.code||e,s.stdout=s.stdout||o),null!=r&&r(s,o)})}function spawnReg(e,t){return spawn(regExe,e,t)}function addToRegistry(e,t){if(0===e.length)return t&&t();const r=e.shift();return r.unshift("add"),r.push("/f"),spawnReg(r,()=>addToRegistry(e,t))}exports.spawn=spawn,exports.spawnReg=spawnReg,exports.addToRegistry=addToRegistry;