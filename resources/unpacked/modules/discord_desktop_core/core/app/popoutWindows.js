"use strict"; Object.defineProperty(exports, "__esModule", { value: !0 }), exports.init = init, exports.getWindow = getWindow, exports.openOrFocusWindow = openOrFocusWindow, exports.closePopouts = closePopouts, exports.hasInit = void 0; var _electron = require("electron"), _appFeatures = require("./appFeatures"), _mainScreen = require("./mainScreen"); const MIN_POPOUT_WIDTH = 320, MIN_POPOUT_HEIGHT = 180, DEFAULT_POPOUT_OPTIONS = { title: "Jesuscord Popout", backgroundColor: "#2f3136", minWidth: 320, minHeight: 180, transparent: !1, frame: "linux" === process.platform, resizable: !0, show: !0, webPreferences: { nodeIntegration: !1, nativeWindowOpen: !0, enableRemoteModule: !1, contextIsolation: !0 } }, features = (0, _appFeatures.getFeatures)(); let hasInit = !1; exports.hasInit = hasInit; let popoutWindows = {}; function init() { hasInit ? console.warn("popoutWindows: Has already init! Cancelling init.") : (exports.hasInit = hasInit = !0, features.declareSupported("popout_windows")) } function focusWindow(e) { null != e && (e.setAlwaysOnTop(!0), e.focus(), e.setAlwaysOnTop(!1)) } function getWindow(e) { return popoutWindows[e] } function openOrFocusWindow(e, o, t, n) { const { width: s, height: i, x: r, y: p, webContents: u } = n, a = popoutWindows[t]; if (null != a) return e.newGuest = a, void focusWindow(a); const c = Object.assign({}, DEFAULT_POPOUT_OPTIONS, { width: s, height: i, x: r, y: p, webContents: u }), d = e.newGuest = new _electron.BrowserWindow(c); d.windowKey = t, popoutWindows[t] = d, o && d.loadURL(o), d.once("closed", () => { d.removeAllListeners(), delete popoutWindows[t] }) } function closePopouts() { Object.values(popoutWindows).forEach(e => e.close()), popoutWindows = {} }