"use strict";const electron=require("electron"),process=require("process"),{PROCESS_UTILS_GET_CPU_USAGE:PROCESS_UTILS_GET_CPU_USAGE,PROCESS_UTILS_GET_MEMORY_INFO:PROCESS_UTILS_GET_MEMORY_INFO,PROCESS_UTILS_FLUSH_DNS_CACHE:PROCESS_UTILS_FLUSH_DNS_CACHE,PROCESS_UTILS_FLUSH_COOKIES:PROCESS_UTILS_FLUSH_COOKIES,PROCESS_UTILS_FLUSH_STORAGE_DATA:PROCESS_UTILS_FLUSH_STORAGE_DATA,PROCESS_UTILS_GET_MAIN_ARGV_SYNC:PROCESS_UTILS_GET_MAIN_ARGV_SYNC}=require("../common/constants").IPCEvents,CPU_USAGE_GATHER_INTERVAL=1e3,MEMORY_USAGE_GATHER_INTERVAL=5e3,mainArgv=electron.ipcRenderer.sendSync(PROCESS_UTILS_GET_MAIN_ARGV_SYNC);let totalProcessorUsagePercent=0,totalMemoryUsageKB=0;async function flushDNSCache(){electron.ipcRenderer.invoke(PROCESS_UTILS_FLUSH_DNS_CACHE)}async function flushCookies(e){try{await electron.ipcRenderer.invoke(PROCESS_UTILS_FLUSH_COOKIES),e()}catch(r){e(r)}}async function flushStorageData(e){try{await electron.ipcRenderer.invoke(PROCESS_UTILS_FLUSH_STORAGE_DATA),e()}catch(r){e(r)}}async function purgeMemory(){electron.webFrame.clearCache()}function getCurrentCPUUsagePercent(){return totalProcessorUsagePercent}function getCurrentMemoryUsageKB(){return totalMemoryUsageKB}function getMainArgvSync(){return mainArgv}setInterval(()=>{electron.ipcRenderer.invoke(PROCESS_UTILS_GET_CPU_USAGE).then(e=>totalProcessorUsagePercent=e)},1e3),setInterval(()=>{Promise.all([process.getProcessMemoryInfo(),electron.ipcRenderer.invoke(PROCESS_UTILS_GET_MEMORY_INFO)].map(e=>e.catch(()=>0))).then(e=>{totalMemoryUsageKB=e.reduce((e,r)=>e+r.private,0)})},5e3),module.exports={flushDNSCache:flushDNSCache,flushCookies:flushCookies,flushStorageData:flushStorageData,purgeMemory:purgeMemory,getCurrentCPUUsagePercent:getCurrentCPUUsagePercent,getCurrentMemoryUsageKB:getCurrentMemoryUsageKB,getMainArgvSync:getMainArgvSync};