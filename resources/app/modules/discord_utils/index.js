const execa=require("execa"),superagent=require("superagent"),{inputCaptureSetWatcher:inputCaptureSetWatcher,inputCaptureRegisterElement:inputCaptureRegisterElement}=require("./input_capture"),{wrapInputEventRegister:wrapInputEventRegister,wrapInputEventUnregister:wrapInputEventUnregister}=require("./input_event");function parseNvidiaSmiOutput(e){if(!e||!e.stdout)return{error:"nvidia-smi produced no output"};const t=e.stdout.match(/Driver Version: (\d+)\.(\d+)/);return 3===t.length?{major:parseInt(t[1],10),minor:parseInt(t[2],10)}:{error:"failed to parse nvidia-smi output"}}module.exports=require("./discord_utils_"+process.platform+".node"),module.exports.clearCandidateGamesCallback=module.exports.setCandidateGamesCallback,inputCaptureSetWatcher(module.exports.inputWatchAll),delete module.exports.inputWatchAll,module.exports.inputCaptureRegisterElement=inputCaptureRegisterElement,module.exports.inputEventRegister=wrapInputEventRegister(module.exports.inputEventRegister),module.exports.inputEventUnregister=wrapInputEventUnregister(module.exports.inputEventUnregister),module.exports.getGPUDriverVersions=async()=>{if("win32"!==process.platform)return{};const e={},t=process.env.ProgramW6432+"/NVIDIA Corporation/NVSMI/nvidia-smi.exe";try{e.nvidia=parseNvidiaSmiOutput(await execa(t,[]))}catch(t){e.nvidia={error:t.toString()}}return e},module.exports.submitLiveCrashReport=async(e,t)=>{const r=module.exports._generateLiveMinidump();if(!r)return null;await superagent.post("https://sentry.io/api/146342/minidump/?sentry_key=f11e8c3e62cb46b5a006c339b2086ba3").attach("upload_file_minidump",r).field("channel",e).field("sentry",JSON.stringify(t))};